<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Info Cuaca - Jakarta</title>
  <link rel="stylesheet" href="index.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
    <div class="wrapper">
      <div class="background"></div>
      <div class="weather-card-sunset">
        <h1 class="kota">Jakarta</h1>
        <h1 class="negara">Indonesia</h1>
        <img class="awan" src="foto/berawan2.png" alt="awan" />
        <h2 class="suhu">19</h2>
        <h2 class="celcius">°C</h2>
        <p class="kondisi">Berawan</p>
        <p class="jam">05.30</p>
        <div class="forecast">
                <h1 class="judul">Ramalan Cuaca</h1>
                  <p class="b">Ramalan 3 hari</p>
                <div class="box-container">
                  <img class="kalender" src="foto/kalender.png" alt="">
                  <p class="a">Hari ini Berawan</p>
                    <img class="awan1" src="foto/berawan2.png" alt="">
                  <p class="c">29°/20°</p>
                  <p class="a1">Besok Berawan</p>
                    <img class="awan2" src="foto/berawan2.png" alt="">
                  <p class="c1">29°/20°</p>
                  <p class="a2">Lusa Berawan </p>
                    <img class="awan3" src="foto/berawan2.png" alt="">
                  <p class="c2"> 29°/20°</p>
                </div>
              <div class="background2"></div>
                  <h1 class="judul1">Ramalan Cuaca</h1>
                    <h2 class="subjudul">Ramalan 24 jam</h2>
                      <img class="jam1"src="foto/clock.png" alt="">
                        <p class="p1">29°</p>
                          <img class="cloud"src="foto/berawan2.png" alt="">
                            <p class="arah">13,0km/j</p>
                              <p class="masa">Sekarang</p>
                        <p class="p2">29°</p>
                          <img class="cloud1"src="foto/berawan2.png" alt="">
                            <p class="arah1">13,0km/j</p>
                              <p class="masa1">14.00</p>
                        <p class="p3">29°</p>
                          <img class="cloud2"src="foto/berawan2.png" alt="">
                            <p class="arah2">13,0km/j</p>
                              <p class="masa2">16.00</p>
                        <p class="p4">29°</p>
                          <img class="cloud3"src="foto/berawan2.png" alt="">
                            <p class="arah3">13,0km/j</p>
                              <p class="masa3">18.00</p>
            </div>
              <div class="box-container1">
                <div class="details">
                  <h1 class="p5">Keterangan</h1>
                  <p class="p6">Kelembapan</p>
                  <p class="p7">55%</p>
                  <p class="p8">Terasa seperti</p>
                  <p class="p9">32</p>
                  <p class="p10">UV</p>
                  <p class="p11">8</p>
                  <p class="p12">Tekanan</p> 
                  <p class="p13">1008</p> 
                  <p class="p14">mbar</p> 
                  <p class="p15">Peluang hujan</p> 
                  <p class="p16">3%</p> 
                </div>
              </div>
            <div class="box-container2">
              <h1 class="judul2">Arah mata angin</h1>
              <h1 class="subjudul1">Arah angin</h1>
              <p class="p17">Selatan</p>
              <h1 class="subjudul2">Kecepatan</h1>
              <p class="p18">13,0km/j</p>
            </div>
            <div class="box-container3"> </div>
              <h1 class="judul3">IKU</h1>
                <img class="daun" src="foto/daun.png" alt="">
              <h1 class="judul4">84</h1>
              <p class="subjudul3">Ramalan Kualitas Udara Sepenuhnya</p>
        <p class="p19">Data disediakan oleh </p>
        <a class="link" href="https://openweathermap.org" target="_blank">Open Weather</a>
      </div>
    </div> 
  <script>
function gantiBackgroundBerdasarkanJam() {
  const jam = new Date().getHours();
  let background = 'foto/sore.jpeg';

  if (jam >= 5 && jam < 6) {
    background = 'foto/pagi.jpeg';
  } else if (jam >= 6 && jam < 16) {
    background = 'foto/siang.jpeg';
  } else if (jam >= 16 && jam < 18) {
    background = 'foto/sore.jpeg';
  } else {
    background = 'foto/malam.jpeg';
  }

  document.querySelector(".background").style.backgroundImage = `url('${background}')`;
}

function showWeather(position) {
  const lat = position.coords.latitude;
  const lon = position.coords.longitude;
  const openWeatherKey = '71a709385242c0f2f64c9aa4a95cf7de';
  const openCageKey = '13257a492d3e4b95a31e9684f765b8e8';

  // Ambil nama kota
  fetch(`https://api.opencagedata.com/geocode/v1/json?q=${lat}+${lon}&key=${openCageKey}&language=id`)
    .then(response => response.json())
    .then(data => {
      const components = data.results[0].components;
      const kota = components.city || components.town || components.village || components.county || "Lokasi tidak ditemukan";
      document.querySelector('.kota').textContent = kota;
    })
    .catch(() => {
      document.querySelector('.kota').textContent = "Lokasi tidak ditemukan";
    });

      // Ambil data cuaca
      fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=id&appid=${openWeatherKey}`)
        .then(response => response.json())
        .then(data => {
          const kondisi = data.weather[0].main.toLowerCase();
          const jam = new Date().getHours();
          const isNight = jam >= 18 || jam < 6;

          let iconPath = 'foto/berawan2.png';
          if (kondisi === 'clear') {
            iconPath = isNight ? 'foto/bulan.png' : 'foto/cerah.png';
          } else if (kondisi === 'clouds') {
            iconPath = isNight ? 'foto/bulan-berawan.png' : 'foto/cerah-berawan2.png';
          } else if (kondisi === 'rain') {
            iconPath = 'foto/hujan.png';
          } else if (kondisi === 'thunderstorm') {
            iconPath = 'foto/hujan-petir.png';
          } else if (kondisi === 'drizzle') {
            iconPath = 'foto/hujan-cerah.png';
          } else if (['mist', 'haze', 'fog'].includes(kondisi)) {
            iconPath = 'foto/pagi-berkabut.png';
          }

          document.querySelector('.suhu').textContent = Math.round(data.main.temp);
          document.querySelector('.kondisi').textContent = data.weather[0].description;
          document.querySelector('.jam').textContent = new Date().toLocaleTimeString('id-ID', {
            hour: '2-digit',
            minute: '2-digit'
          });
          document.querySelector('.awan').src = iconPath;
        })
        .catch(() => {
          alert("Gagal mengambil data cuaca.");
        });
    }

    function showError(error) {
      alert("Gagal mendapatkan lokasi. Aktifkan izin lokasi.");
      console.warn(error);
    }

    // Jalankan saat halaman dimuat
    gantiBackgroundBerdasarkanJam();
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showWeather, showError);
    } else {
      alert("Browser tidak mendukung Geolocation.");
    }
  </script>
</body>
</html>
